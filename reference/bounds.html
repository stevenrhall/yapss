
<!DOCTYPE html>

<html class="writer-html5" data-content_root="../" lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Setting Bounds — YAPSS 0.1.1.dev0</title>
<link href="../_static/pygments.css?v=77553476" rel="stylesheet" type="text/css"/>
<link href="../_static/css/theme.css?v=e59714d7" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css" rel="stylesheet" type="text/css"/>
<script src="../_static/jquery.js?v=5d32c60e"></script>
<script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
<script src="../_static/documentation_options.js?v=091d38aa"></script>
<script src="../_static/doctools.js?v=9a2dae69"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=35a8b989"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="../_static/js/theme.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="guess.html" rel="next" title="Initial Guess"/>
<link href="callbacks.html" rel="prev" title="Callback Functions"/>
</head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../index.html">
            YAPSS
          </a>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/tutorial.html">Tutorial Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="problem.html">Problem Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="callbacks.html">Callback Functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setting Bounds</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#list-of-bounds">List of Bounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#special-considerations-for-state-bounds">Special Considerations for State Bounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-reset-method">The <code class="docutils literal notranslate"><span class="pre">reset()</span></code> Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-validation">Input Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bounds-class-reference"><code class="docutils literal notranslate"><span class="pre">Bounds</span></code> Class Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#yapss._private.bounds.Bounds"><code class="docutils literal notranslate"><span class="pre">Bounds</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#yapss._private.bounds.Bounds.reset"><code class="docutils literal notranslate"><span class="pre">Bounds.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#yapss._private.bounds.Bounds.validate"><code class="docutils literal notranslate"><span class="pre">Bounds.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guess.html">Initial Guess</a></li>
<li class="toctree-l1"><a class="reference internal" href="derivatives.html">Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_derivatives.html">User-Defined Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="scaling.html">Scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh_structure.html">Mesh Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipopt_options.html">Ipopt Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="solution.html">The Solution Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuring the Ipopt Binary Source</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/index.html">JupyterLab Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Python Scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing to YAPSS</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../index.html">YAPSS</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="Page navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Home" class="icon icon-home" href="../index.html"></a></li>
<li class="breadcrumb-item active">Setting Bounds</li>
<li class="wy-breadcrumbs-aside">
<a class="fa fa-github" href="https://github.com/stevenrhall/yapss/blob/main/docs/user_guide/reference/bounds.rst"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<section id="setting-bounds">
<h1>Setting Bounds<a class="headerlink" href="#setting-bounds" title="Link to this heading"></a></h1>
<p>After a problem has been instantiated, bounds on decision variables and constraints can be
set using the <code class="docutils literal notranslate"><span class="pre">bounds</span></code> attribute of the problem object. The hierarchical structure of
the <code class="docutils literal notranslate"><span class="pre">Bounds</span></code> class reflects the structure of the problem decision variables and
constraints. In YAPSS, all bounds are initialized with default values <em>+inf</em> for upper
bounds and <em>-inf</em> for lower bounds, except for phase durations, for which the lower bound
defaults to zero.</p>
<p>Consider the HS071 problem example below, where bounds are defined for parameters and discrete
constraints.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yapss</span> <span class="kn">import</span> <span class="n">Problem</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"HS071"</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="p">[],</span> <span class="n">ns</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nd</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">discrete</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="mf">25.0</span><span class="p">,</span> <span class="mf">40.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">discrete</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">40.0</span>
</pre></div>
</div>
<p>In this example, there are four decision variables (the four parameters), and two discrete
constraints. Each parameter is bounded between 1 and 5, and the first discrete constraint is bounded
between 25 and 40, while the second discrete constraint is bounded below by 40, without an upper
limit.</p>
<p>Additional bounds can be set for each phase in the problem, covering variables like initial and
final time, duration, states, controls, integral values, and path constraints.</p>
<p>Except for the bounds on the initial time, final time, and duration of each phase, all the bounds
are arrays, and their values are implemented as NumPy arrays. Bound values to be set can be
addressed using either slicing or direct assignment. For instance, the following three lines are functionally
equivalent:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">lower</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span>
</pre></div>
</div>
<section id="list-of-bounds">
<h2>List of Bounds<a class="headerlink" href="#list-of-bounds" title="Link to this heading"></a></h2>
<p>The available bounds include:</p>
<p><strong>Time Bounds</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].initial_time.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].initial_time.lower</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].final_time.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].final_time.lower</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].duration.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].duration.lower</span></code></p></li>
</ul>
<p>To ensure feasibility, set these bounds with care. For example, each phase must satisfy:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">initial_time.lower</span></code> ≤ <code class="docutils literal notranslate"><span class="pre">final_time.upper</span></code></p>
</div></blockquote>
<p>and</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">final_time.lower</span></code> - <code class="docutils literal notranslate"><span class="pre">initial_time.upper</span></code> ≤ <code class="docutils literal notranslate"><span class="pre">duration.upper</span></code></p>
</div></blockquote>
<p><strong>State Bounds</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].initial_state.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].initial_state.lower</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].final_state.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].final_state.lower</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].state.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].state.lower</span></code></p></li>
</ul>
<p>These bounds should be consistent across phases. For example:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">final_state.lower</span></code> ≤ <code class="docutils literal notranslate"><span class="pre">state.upper</span></code></p>
</div></blockquote>
<p><strong>Control, Path, and Integral Bounds</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].control.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].control.lower</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].path.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].path.lower</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.phase[k].integral.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.phase[k].integral.lower</span></code></p></li>
</ul>
<p><strong>Parameter and Discrete Constraint Bounds</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.parameter.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.parameter.lower</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds.discrete.upper</span></code>, <code class="docutils literal notranslate"><span class="pre">bounds.discrete.lower</span></code></p></li>
</ul>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<p>Consider the dynamic soaring problem. It has six states, two controls, one path
constraint, three discrete constraints, and a single parameter for wind shear rate. We
initialize the bounds for this problem as follows:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yapss</span> <span class="kn">import</span> <span class="n">Problem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"dynamic soaring"</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">nu</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">nh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nd</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>The initial time is set to zero, with an expected duration between 10 and 30 seconds:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The initial time is fixed to be 0. The final time will be between 10 and 30.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">initial_time</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">initial_time</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">final_time</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">final_time</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The initial time is fixed to be 0. The final time will be between 10 and 30.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">initial_time</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">initial_time</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">final_time</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">final_time</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="mi">30</span>
</pre></div>
</div>
<p>The initial and final states are set to zero, and there are bounds on the control
variables (lift coefficient and bank angle) from the problem statement:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The initial and final positions are at the origin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">initial_state</span><span class="o">.</span><span class="n">lower</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">initial_state</span><span class="o">.</span><span class="n">upper</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">final_state</span><span class="o">.</span><span class="n">lower</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">final_state</span><span class="o">.</span><span class="n">upper</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># CL_max &lt;= 1.5. Set loose box bound on bank angle.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">75</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Limits on the normal load</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,)</span>
</pre></div>
</div>
<p>There’s also a discrete constraint that imposes a periodicity condition on the velocity,
flight path angle, and heading angle:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Discrete constraints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">discrete</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">discrete</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">360</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition, it’s good practice to set loose box bounds on the decision variables, which
can sometimes improve the performance of the Ipopt solver:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set loose box bounds on the state.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># None of these should be active in the solution.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1500</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="o">-</span><span class="mi">225</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1500</span><span class="p">,</span> <span class="o">+</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">75</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">225</span><span class="p">)</span>
</pre></div>
</div>
<p>Bounds on initial and final states, position, and control variables are then set based on the
problem requirements, as shown in this detailed example.</p>
</section>
<section id="special-considerations-for-state-bounds">
<h2>Special Considerations for State Bounds<a class="headerlink" href="#special-considerations-for-state-bounds" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section applies only to problems where state bounds act as path constraints, and
where accurate Lagrange multipliers are required.</p>
</div>
<p>Broadly speaking, state constraints of the form</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1000.0</span>
</pre></div>
</div>
<p>might be used in one of two ways:</p>
<ol class="arabic simple">
<li><p>As inactive bounds to aid solver convergence without constraining the final solution.</p></li>
<li><p>As path constraints, where bounds are expected to be active in the final solution.</p></li>
</ol>
<p>In the case where state bounds are intended to be path constraints, the user should instead
use path constraints in the user-defined continuous function, as below:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">continuous</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Apply state[1] as a path constraint</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">arg</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span><span class="o">.</span><span class="n">continuous</span> <span class="o">=</span> <span class="n">continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1000.0</span>
</pre></div>
</div>
<p>While both approaches yield the correct primal solution (decision variables), state bounds
applied directly as path constraints may lead to incorrect Lagrange multipliers —
particularly for initial and final states. In order to obtain accurate numerical results,
path constraints should be applied and Lagrange multipliers calculated only at collocation
points, not all interpolation points, to be consistent with pseudospectral integration
scheme. In addition, without additional logic, it’s difficult to determine whether the
Lagrange multipliers returned by the NLP solver should be associated with the endpoint
state constraints or the state path constraint.</p>
<p>For these reasons, state bounds expected to be active should be implemented as true path
constraints, as shown in the example above. Note that these considerations do <em>not</em> apply
to constraints on control variables.</p>
</section>
<section id="the-reset-method">
<h2>The <code class="docutils literal notranslate"><span class="pre">reset()</span></code> Method<a class="headerlink" href="#the-reset-method" title="Link to this heading"></a></h2>
<p>To reset bounds, call the <code class="docutils literal notranslate"><span class="pre">reset()</span></code> method at any level in the <code class="docutils literal notranslate"><span class="pre">Bounds</span></code> hierarchy. For
instance:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Resets all bounds</span>
</pre></div>
</div>
<p>or for a single phase:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">problem</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Resets bounds for phase 0</span>
</pre></div>
</div>
</section>
<section id="input-validation">
<h2>Input Validation<a class="headerlink" href="#input-validation" title="Link to this heading"></a></h2>
<p>Setting bounds correctly can be error-prone, so YAPSS helps reduce errors by validating
bounds configurations. Errors are caught when assigning values, with helpful feedback. For
example, trying to assign a scalar instead of a sequence for path constraints raises an
error:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">ArrayBound must be a sequence of floats of length 1.</span>
</pre></div>
</div>
<p>Similarly, trying to set conflicting control bounds results in an error:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">75</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Failed to set bound.phase[0].control.lower.</span>
<span class="x">Must have bound.phase[0].control.upper[i] &gt;= bound.phase[0].control.lower[i] for all i.</span>
<span class="x">Condition failed for i in [1].</span>
</pre></div>
</div>
</section>
<section id="bounds-class-reference">
<h2><code class="docutils literal notranslate"><span class="pre">Bounds</span></code> Class Reference<a class="headerlink" href="#bounds-class-reference" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="yapss._private.bounds.Bounds">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">problem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="problem.html#yapss.Problem" title="yapss.Problem"><span class="pre">yapss.Problem</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yapss/_private/bounds.html#Bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yapss._private.bounds.Bounds" title="Link to this definition"></a></dt>
<dd><p>Represents bounds on variables and constraints in an optimal control problem.</p>
<p>The <cite>Bounds</cite> class organizes and manages the bounds for decision variables and constraints
in a hierarchical structure tailored to the optimal control problem. Each variable or
constraint in the hierarchy has associated <cite>upper</cite> and <cite>lower</cite> bounds, along with methods
to validate and reset the bounds.</p>
<p>Each bounded variable in the hierarchy includes the following attributes:</p>
<blockquote>
<div><dl class="simple">
<dt>upper<span class="classifier">float or np.ndarray</span></dt><dd><p>The upper bound.</p>
</dd>
<dt>lower<span class="classifier">float or np.ndarray</span></dt><dd><p>The lower bound.</p>
</dd>
<dt>validate()<span class="classifier">method</span></dt><dd><p>Validates user-defined bounds, raising a <cite>ValueError</cite> if they are infeasible.</p>
</dd>
<dt>reset()<span class="classifier">method</span></dt><dd><p>Resets bounds to default values (<cite>+inf</cite> for upper bounds, <cite>-inf</cite> for lower
bounds), except for phase durations where the lower bound is set to zero.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>parameter</strong><span class="classifier">ArrayBounds</span></dt><dd><p>Bounds for the parameters in the optimal control problem.</p>
</dd>
<dt><strong>discrete</strong><span class="classifier">ArrayBounds</span></dt><dd><p>Bounds for discrete constraint functions within the problem.</p>
</dd>
<dt><strong>phase</strong><span class="classifier">tuple of PhaseBounds</span></dt><dd><p>A tuple of <cite>PhaseBounds</cite> instances, where each <cite>PhaseBounds</cite> instance represents the bounds
associated with one phase in the problem. Each <cite>PhaseBounds</cite> instance has the attributes:</p>
<dl class="simple">
<dt>control<span class="classifier">ArrayBounds</span></dt><dd><p>Bounds for control variables within the phase.</p>
</dd>
<dt>state<span class="classifier">ArrayBounds</span></dt><dd><p>Bounds for state variables within the phase.</p>
</dd>
<dt>initial_state<span class="classifier">ArrayBounds</span></dt><dd><p>Bounds on the initial state for the phase.</p>
</dd>
<dt>final_state<span class="classifier">ArrayBounds</span></dt><dd><p>Bounds on the final state for the phase.</p>
</dd>
<dt>initial_time<span class="classifier">ScalarBounds</span></dt><dd><p>Bounds on the initial time of the phase.</p>
</dd>
<dt>final_time<span class="classifier">ScalarBounds</span></dt><dd><p>Bounds on the final time of the phase.</p>
</dd>
<dt>duration<span class="classifier">ScalarBounds</span></dt><dd><p>Bounds on the duration of the phase, with a default lower bound of zero.</p>
</dd>
<dt>integral<span class="classifier">ArrayBounds</span></dt><dd><p>Bounds for any integral values defined over the phase.</p>
</dd>
<dt>path<span class="classifier">ArrayBounds</span></dt><dd><p>Bounds for path constraints applied to the phase.</p>
</dd>
<dt>zero_mode<span class="classifier">ArrayBounds</span></dt><dd><p>Bounds for the state “zero modes”</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="yapss._private.bounds.Bounds.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/yapss/_private/bounds.html#Bounds.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yapss._private.bounds.Bounds.reset" title="Link to this definition"></a></dt>
<dd><p>Reset all bounds to default values across phases, parameters, and constraints.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="yapss._private.bounds.Bounds.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/yapss/_private/bounds.html#Bounds.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yapss._private.bounds.Bounds.validate" title="Link to this definition"></a></dt>
<dd><p>Validate the bounds for each variable and constraint in the problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If infeasible bounds are detected.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
</section>
</div>
</div>
<footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="callbacks.html" rel="prev" title="Callback Functions"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
<a accesskey="n" class="btn btn-neutral float-right" href="guess.html" rel="next" title="Initial Guess">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<p>© Copyright 2021-2024 MIT.
      <span class="lastupdated">Last updated on Dec 29, 2024.
      </span></p>
</div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
</div>
</div>
</section>
</div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>